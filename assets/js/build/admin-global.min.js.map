{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./assets/js/src/utils/loaders.js","webpack:///./assets/js/src/utils/ratings.js","webpack:///./assets/js/src/utils/index.js","webpack:///./assets/js/src/admin/modules/dates.js","webpack:///external \"jQuery\"","webpack:///./assets/js/src/utils/api-request.js","webpack:///./assets/js/src/admin/modules/dashboard-widgets.js","webpack:///./assets/js/src/admin/modules/post-metabox.js","webpack:///./assets/js/src/admin/global.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","spinButton","button","newText","bdbVars","is_admin","please_wait","prop","data","text","html","unspinButton","getStars","rating","fullStars","Math","floor","halfStars","ceil","repeat","formatMySQL","formatDisplay","dateUTCtoLocal","utcDate","format","moment","utc","local","dateLocalToUTC","localDate","jQuery","apiRequest","endpoint","options","method","url","api_base","beforeSend","xhr","setRequestHeader","api_nonce","xhrFields","withCredentials","Promise","resolve","reject","$","ajax","success","response","error","qpXHR","textStatus","errorThrown","generic_erroc","responseJSON","message","ajaxRequest","args","dataType","ajaxurl","BDB_Dashboard_Widgets","init","on","this","updatePercentage","setUnit","saveProgress","saveProgressOnEnter","finishBook","dnfBook","setRating","e","preventDefault","closest","find","slideToggle","wrap","unit","removeClass","addClass","hide","show","readablePercentage","logID","percentage","progressWrap","progressNumber","pageField","maxPages","parseInt","currentPage","val","round","percentageField","parseFloat","percentage_complete","then","apiResponse","css","catch","errorMessage","console","log","finally","slideUp","keyCode","trigger","confirm","confirm_finish_book","date_finished","remove","confirm_dnf_book","empty","append","BDB_Post_Metabox","postID","userID","bookID","table","tableBody","errorWrap","searchResultsWrap","document","getElementById","getReviews","toggleSearch","searchBooks","selectBook","addReview","disassociateReview","deleteReview","rating_format","review_query","field","length","wp","template","each","review","type","which","search","searchType","author_query","operator","book_query","no_books","booksHTML","book","id","title","by","author_name","book_id","logOptions","shapeLog","readingLog","date_started_formatted","date_started","date_finished_formatted","stars","unknown","reading_log_id","user_id","post_id","confirm_remove_review_association","confirm_delete_review"],"mappings":"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","file":"assets/js/build/admin-global.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 22);\n","/* global $, bdbVars */\n\n/**\n * Spin a button\n *\n *      - Disables the button\n *      - Saves the current button text to `data-text`\n *      - Changes the text to either a WP-Admin spinner or \"Please Wait...\"\n *\n * @param button\n */\nexport function spinButton( button ) {\n\n\tlet newText = bdbVars.is_admin ? '<span class=\"spinner is-active\"></span>' : bdbVars.please_wait;\n\n\tbutton.prop( 'disabled', true ).data( 'text', button.text() ).html( newText );\n\n}\n\n/**\n * Unspin a button\n *\n *      - Enables teh button\n *      - Sets the text to the `data-text` attribute value\n *\n * @param button\n */\nexport function unspinButton( button ) {\n\tbutton.prop( 'disabled', false ).text( button.data( 'text' ) );\n}","/* global $, bdbVars */\n\n/**\n * Convert a numberical star rating into HTML stars\n *\n * @param rating\n * @returns {string}\n */\nexport function getStars( rating ) {\n\n\tlet html = '';\n\tlet fullStars = Math.floor( rating );\n\tlet halfStars = Math.ceil( rating - fullStars );\n\tlet fullStarString = '&starf;';\n\tlet halfStarString = '&half;';\n\n\thtml += fullStarString.repeat( fullStars );\n\thtml += halfStarString.repeat( halfStars );\n\n\treturn html;\n\n}","export * from './api-request.js';\nexport * from './loaders.js';\nexport * from './ratings.js';","/* global $, bdbVars, moment */\n\nconst formatMySQL = 'YYYY-MM-DD HH:mm:ss';\nconst formatDisplay = 'MMMM D, YYYY';\n\n/**\n * Converts a UTC date string to local time in YYYY-mm-dd format.\n *\n * @param {string} utcDate\n * @param {string} format\n * @returns {string}\n */\nexport function dateUTCtoLocal( utcDate, format = 'mysql' ) {\n\n\tif ( '' === utcDate || ! utcDate) {\n\t\treturn '';\n\t}\n\n\tif ( 'display' === format ) {\n\t\tformat = formatDisplay;\n\t} else {\n\t\tformat = formatMySQL;\n\t}\n\n\tutcDate = moment.utc( utcDate );\n\n\t//console.log( 'UTC Date', utcDate );\n\n\tlet localDate = utcDate.local().format( format );\n\n\t//console.log( 'Local Date', localDate );\n\n\treturn localDate;\n\n}\n\n/**\n * Converts a local date string to UTC in YYYY-mm-dd format.\n *\n * @param {string} localDate\n * @returns {string}\n */\nexport function dateLocalToUTC( localDate ) {\n\n\tif ( '' === localDate || ! localDate ) {\n\t\treturn '';\n\t}\n\n\tlocalDate = moment( localDate );\n\n\t//console.log( 'Local Date', localDate );\n\n\tlet utcDate = localDate.utc().format( formatMySQL );\n\n\t//console.log( 'UTC Date', utcDate );\n\n\treturn utcDate;\n\n}","module.exports = jQuery;","/* global $, bdbVars, ajaxurl */\n\n/**\n * Make a request to the REST API\n *\n * @param {string} endpoint\n * @param {object} data\n * @param {string} method\n * @returns {Promise}\n */\nexport function apiRequest( endpoint, data = {}, method = 'POST' ) {\n\tconst options = {\n\t\tmethod: method,\n\t\turl: bdbVars.api_base + 'book-database/' + endpoint,\n\t\tbeforeSend: function ( xhr ) {\n\t\t\txhr.setRequestHeader( 'X-WP-Nonce', bdbVars.api_nonce );\n\t\t},\n\t\txhrFields: {\n\t\t\twithCredentials: true,\n\t\t},\n\t\tdata: data\n\t};\n\n\t//console.log( 'API endpoint', endpoint );\n\n\treturn new Promise( function ( resolve, reject ) {\n\t\t$.ajax( options ).success( function ( response ) {\n\t\t\t//console.log( 'Success response', response );\n\t\t\tresolve( response );\n\t\t} ).error( function ( qpXHR, textStatus, errorThrown ) {\n\t\t\tlet error = bdbVars.generic_erroc;\n\n\t\t\tif ( 'undefined' !== typeof qpXHR.responseJSON ) {\n\t\t\t\terror = qpXHR.responseJSON;\n\n\t\t\t\tif ( 'undefined' !== typeof error.message ) {\n\t\t\t\t\terror = error.message;\n\t\t\t\t}\n\t\t\t} else if ( 'undefined' !== typeof qpXHR.message ) {\n\t\t\t\terror = qpXHR.message;\n\t\t\t}\n\n\t\t\treject( error );\n\t\t} );\n\t} );\n}\n\n/**\n * Make an ajax request\n *\n * @param {object} args\n * @returns {Promise}\n */\nexport function ajaxRequest( args ) {\n\n\tconst options = {\n\t\tmethod: 'POST',\n\t\tdataType: 'JSON',\n\t\turl: ajaxurl,\n\t\tdata: args\n\t};\n\n\treturn new Promise( function ( resolve, reject ) {\n\t\t$.ajax( options ).success( function ( response ) {\n\t\t\tif ( ! response.success ) {\n\t\t\t\t//console.log( 'Error response', response );\n\t\t\t\treject( response.data );\n\t\t\t} else {\n\t\t\t\t//console.log( 'Success response', response );\n\t\t\t\tresolve( response.data );\n\t\t\t}\n\t\t} ).error( function ( qpXHR, textStatus, errorThrown ) {\n\t\t\tlet error = bdbVars.generic_erroc;\n\n\t\t\tif ( 'undefined' !== typeof qpXHR.responseJSON ) {\n\t\t\t\terror = qpXHR.responseJSON;\n\n\t\t\t\tif ( 'undefined' !== typeof error.message ) {\n\t\t\t\t\terror = error.message;\n\t\t\t\t}\n\t\t\t} else if ( 'undefined' !== typeof qpXHR.message ) {\n\t\t\t\terror = qpXHR.message;\n\t\t\t}\n\n\t\t\treject( error );\n\t\t} );\n\t} );\n\n}","/* global $, bdbVars, wp */\n\nimport { apiRequest, spinButton, unspinButton, getStars } from 'utils';\n\n/**\n * Admin Dashboard Widgets\n */\nvar BDB_Dashboard_Widgets = {\n\n\t/**\n\t * Initialize\n\t */\n\tinit: function() {\n\n\t\t$( '.bdb-currently-reading-widget-update-progress' ).on( 'click', this.updatePercentage );\n\t\t$( '.bdb-currently-reading-progress-unit-choices' ).on( 'click', 'a', this.setUnit );\n\t\t$( '.bdb-currently-reading-widget-save-progress' ).on( 'click', this.saveProgress );\n\t\t$( '.bdb-currently-reading-set-progress-wrap' ).on( 'keydown', 'input', this.saveProgressOnEnter );\n\t\t$( '.bdb-currently-reading-widget-finish-book' ).on( 'click', this.finishBook );\n\t\t$( '.bdb-currently-reading-widget-dnf-book' ).on( 'click', this.dnfBook );\n\t\t$( '.bdb-currently-reading-widget-set-rating' ).on( 'click', this.setRating );\n\n\t},\n\n\t/**\n\t * Update the percentage\n\t *\n\t * @param e\n\t */\n\tupdatePercentage: function ( e ) {\n\n\t\te.preventDefault();\n\n\t\tlet wrap = $( this ).closest( 'li' );\n\n\t\twrap.find( '.bdb-currently-reading-set-progress-wrap' ).slideToggle();\n\n\t},\n\n\t/**\n\t * Set the unit to use for updating progress\n\t *\n\t * @param e\n\t */\n\tsetUnit: function ( e ) {\n\n\t\te.preventDefault();\n\n\t\tlet wrap = $( this ).closest( '.bdb-currently-reading-set-progress-wrap' ),\n\t\t\tunit = $( this ).data( 'unit' );\n\n\t\twrap.find( '.bdb-currently-reading-progress-unit-choices a' ).removeClass( 'bdb-currently-reading-progress-unit-selected' );\n\t\t$( this ).addClass( 'bdb-currently-reading-progress-unit-selected' );\n\n\t\tif ( 'page' === unit ) {\n\t\t\twrap.find( '.bdb-currently-reading-unit-percentage-wrap' ).hide();\n\t\t\twrap.find( '.bdb-currently-reading-unit-pages-wrap' ).show();\n\t\t} else {\n\t\t\twrap.find( '.bdb-currently-reading-unit-percentage-wrap' ).show();\n\t\t\twrap.find( '.bdb-currently-reading-unit-pages-wrap' ).hide();\n\t\t}\n\n\t},\n\n\t/**\n\t * Save the new progress\n\t *\n\t * @param e\n\t */\n\tsaveProgress: function ( e ) {\n\n\t\te.preventDefault();\n\n\t\tlet button = $( this ),\n\t\t\twrap = button.closest( 'li' ),\n\t\t\tlogID = wrap.data( 'log-id' ),\n\t\t\tunit = wrap.find( '.bdb-currently-reading-progress-unit-selected' ).data( 'unit' ),\n\t\t\tpercentage = 0,\n\t\t\treadablePercentage,\n\t\t\tprogressWrap = wrap.find( '.bdb-currently-reading-progress-bar' ),\n\t\t\tprogressNumber = wrap.find( '.bdb-currently-reading-progress-number' );\n\n\t\tspinButton( button );\n\n\t\t// Figure out the percentage.\n\t\tif ( 'page' === unit ) {\n\t\t\tlet pageField = wrap.find( '.bdb-currently-reading-unit-page' ),\n\t\t\t\tmaxPages = parseInt( pageField.data( 'max' ) ),\n\t\t\t\tcurrentPage = parseInt( pageField.val() );\n\n\t\t\tif ( maxPages > 0 ) {\n\t\t\t\tpercentage = currentPage / maxPages;\n\t\t\t\treadablePercentage = Math.round( percentage * 100 );\n\t\t\t}\n\t\t} else {\n\t\t\tlet percentageField = wrap.find( '.bdb-currently-reading-unit-percentage' );\n\n\t\t\treadablePercentage = parseFloat( percentageField.val() );\n\n\t\t\tif ( readablePercentage > 0 ) {\n\t\t\t\tpercentage = readablePercentage / 100;\n\t\t\t}\n\t\t}\n\n\t\tlet args = {\n\t\t\tpercentage_complete: percentage\n\t\t};\n\n\t\tapiRequest( 'v1/reading-log/update/' + logID, args, 'POST' ).then( function( apiResponse ) {\n\t\t\tprogressWrap.css( 'width', readablePercentage + '%' );\n\t\t\tprogressNumber.text( readablePercentage + '%' );\n\t\t} ).catch( function( errorMessage ) {\n\t\t\tconsole.log( errorMessage );\n\t\t} ).finally( function() {\n\t\t\tunspinButton( button );\n\t\t\twrap.find( '.bdb-currently-reading-set-progress-wrap' ).slideUp();\n\t\t} );\n\n\t},\n\n\t/**\n\t * Trigger progress saving when clicking \"enter\"\n\t *\n\t * @param e\n\t */\n\tsaveProgressOnEnter: function ( e ) {\n\n\t\tif ( 13 === e.keyCode ) {\n\t\t\te.preventDefault();\n\n\t\t\t$( this ).closest( 'li' ).find( '.bdb-currently-reading-widget-save-progress' ).trigger( 'click' );\n\t\t}\n\n\t},\n\n\t/**\n\t * Finish a book\n\t *\n\t * This sets the percentage to 100% and the finished date to today.\n\t *\n\t * @param e\n\t */\n\tfinishBook: function ( e ) {\n\n\t\te.preventDefault();\n\n\t\tif ( ! confirm( bdbVars.confirm_finish_book ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet button = $( this );\n\n\t\tspinButton( button );\n\n\t\tlet wrap = button.closest( 'li' );\n\n\t\tlet args = {\n\t\t\tpercentage_complete: 1,\n\t\t\tdate_finished: wrap.data( 'now' )\n\t\t};\n\n\t\tapiRequest( 'v1/reading-log/update/' + wrap.data( 'log-id' ), args, 'POST' ).then( function( apiResponse ) {\n\t\t\twrap.find( '.bdb-currently-reading-data' ).remove();\n\t\t\twrap.find( '.bdb-currently-reading-rate-book' ).show();\n\t\t} ).catch( function( errorMessage ) {\n\t\t\tconsole.log( errorMessage );\n\t\t} ).finally( function() {\n\t\t\tunspinButton( button );\n\t\t} );\n\n\t},\n\n\t/**\n\t * DNF book\n\t *\n\t * @param e\n\t * @returns {boolean}\n\t */\n\tdnfBook: function ( e ) {\n\n\t\te.preventDefault();\n\n\t\tif ( ! confirm( bdbVars.confirm_dnf_book ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet button = $( this );\n\n\t\tspinButton( button );\n\n\t\tlet wrap = button.closest( 'li' );\n\n\t\tlet args = {\n\t\t\tdate_finished: wrap.data( 'now' )\n\t\t};\n\n\t\tapiRequest( 'v1/reading-log/update/' + wrap.data( 'log-id' ), args, 'POST' ).then( function( apiResponse ) {\n\t\t\twrap.find( '.bdb-currently-reading-data' ).remove();\n\t\t\twrap.find( '.bdb-currently-reading-rate-book' ).show();\n\t\t} ).catch( function( errorMessage ) {\n\t\t\tconsole.log( errorMessage );\n\t\t} ).finally( function() {\n\t\t\tunspinButton( button );\n\t\t} );\n\n\t},\n\n\t/**\n\t * Set the rating\n\t *\n\t * @param e\n\t */\n\tsetRating: function ( e ) {\n\n\t\te.preventDefault();\n\n\t\tlet button = $( this );\n\n\t\tspinButton( button );\n\n\t\tlet wrap = button.closest( 'li' );\n\n\t\tlet args = {\n\t\t\trating: wrap.find( '.bdb-currently-reading-rating' ).val()\n\t\t};\n\n\t\tapiRequest( 'v1/reading-log/update/' + wrap.data( 'log-id' ), args, 'POST' ).then( function( apiResponse ) {\n\t\t\twrap.find( '.bdb-currently-reading-rate-book' ).empty().append( '<p>' + getStars( args.rating ) + '</p>' )\n\t\t} ).catch( function( errorMessage ) {\n\t\t\tconsole.log( errorMessage );\n\t\t} ).finally( function() {\n\t\t\tunspinButton( button );\n\t\t} );\n\n\t}\n\n};\n\nexport { BDB_Dashboard_Widgets }","/* global $, bdbVars, wp */\n\nimport { apiRequest, spinButton, unspinButton } from 'utils';\nimport { dateLocalToUTC, dateUTCtoLocal } from \"./dates\";\n\n/**\n * Post Metabox\n */\nvar BDB_Post_Metabox = {\n\n\tpostID: 0,\n\n\tuserID: 0,\n\n\tbookID: 0,\n\n\ttable: false,\n\n\ttableBody: false,\n\n\terrorWrap: false,\n\n\tsearchResultsWrap: false,\n\n\t/**\n\t * Initialize\n\t */\n\tinit: function() {\n\n\t\tif ( ! document.getElementById('bdb-post-reviews-table') ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.table = $( '#bdb-post-reviews-table' );\n\t\tthis.postID = this.table.data( 'post-id' );\n\t\tthis.userID = this.table.data( 'user-id' );\n\t\tthis.tableBody = this.table.find( 'tbody' );\n\t\tthis.errorWrap = $( '#bdb-post-reviews-errors' );\n\t\tthis.searchResultsWrap = $( '#bdb-book-search-results' );\n\n\t\tthis.getReviews();\n\n\t\t$( '#bdb-associated-review-post' ).on( 'click', this.toggleSearch );\n\t\t$( '#bdb-search-book-title-author' ).on( 'keypress', this.searchBooks );\n\t\t$( '#bdb-search-book-fields' ).on( 'click', 'button', this.searchBooks );\n\t\tthis.searchResultsWrap.on( 'click', 'a', this.selectBook );\n\t\t$( '#bdb-add-review' ).on( 'click', this.addReview );\n\t\t$( document ).on( 'click', '.bdb-disassociate-review-from-post', this.disassociateReview );\n\t\t$( document ).on( 'click', '.bdb-delete-review', this.deleteReview );\n\n\t},\n\n\t/**\n\t * Get the reviews associated with this post\n\t */\n\tgetReviews: function() {\n\n\t\tlet args = {\n\t\t\trating_format: 'text',\n\t\t\treview_query: [ {\n\t\t\t\tfield: 'post_id',\n\t\t\t\tvalue: BDB_Post_Metabox.postID\n\t\t\t} ]\n\t\t};\n\n\t\tapiRequest( 'v1/reviews', args, 'GET' ).then( function( response ) {\n\n\t\t\tBDB_Post_Metabox.tableBody.empty();\n\n\t\t\tif ( 0 === response.length || 'undefined' === typeof response.length ) {\n\t\t\t\tBDB_Post_Metabox.tableBody.append( wp.template( 'bdb-table-post-reviews-row-empty' ) );\n\t\t\t} else {\n\t\t\t\t$.each( response, function( key, review ) {\n\t\t\t\t\tBDB_Post_Metabox.tableBody.append( wp.template( 'bdb-table-post-reviews-row' )( review ) );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t} ).catch( function( error ) {\n\t\t\tBDB_Post_Metabox.errorWrap.empty().append( error ).show();\n\t\t} );\n\n\t},\n\n\t/**\n\t * Toggle the search fields\n\t *\n\t * @param e\n\t */\n\ttoggleSearch: function ( e ) {\n\t\te.preventDefault();\n\t\t$( '#bdb-search-book-fields' ).slideToggle();\n\t},\n\n\t/**\n\t * Search for books\n\t *\n\t * @param e\n\t */\n\tsearchBooks: function ( e ) {\n\n\t\tif ( 'click' === e.type ) {\n\t\t\te.preventDefault();\n\t\t}\n\n\t\tif ( 'keypress' === e.type && 13 !== e.which ) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\te.preventDefault();\n\t\t}\n\n\t\tlet button = $( '#bdb-search-book-fields' ).find( 'button' ),\n\t\t\tsearch = $( '#bdb-search-book-title-author' ).val(),\n\t\t\tsearchType = $( '#bdb-search-book-type' ).val(),\n\t\t\targs = {};\n\n\t\tspinButton( button );\n\n\t\tBDB_Post_Metabox.errorWrap.empty().hide();\n\t\tBDB_Post_Metabox.searchResultsWrap.empty();\n\n\t\tif ( 'author' === searchType ) {\n\t\t\targs.author_query = [ {\n\t\t\t\tfield: 'name',\n\t\t\t\tvalue: search,\n\t\t\t\toperator: 'LIKE'\n\t\t\t} ];\n\t\t} else {\n\t\t\targs.book_query = [ {\n\t\t\t\tfield: 'title',\n\t\t\t\tvalue: search,\n\t\t\t\toperator: 'LIKE'\n\t\t\t} ];\n\t\t}\n\n\t\tapiRequest( 'v1/books', args, 'GET' ).then( function( apiResponse ) {\n\n\t\t\tif ( 0 === apiResponse.length || 'undefined' === typeof apiResponse.length ) {\n\t\t\t\tBDB_Post_Metabox.searchResultsWrap.append( '<p>' + bdbVars.no_books + '</p>' );\n\t\t\t} else {\n\t\t\t\tlet booksHTML = '';\n\t\t\t\t$.each( apiResponse, function( key, book ) {\n\t\t\t\t\tbooksHTML = booksHTML + '<li><a href=\"#\" data-id=\"' + book.id + '\">' + book.title + ' ' + bdbVars.by + ' ' + book.author_name + '</a></li>';\n\t\t\t\t} );\n\t\t\t\tBDB_Post_Metabox.searchResultsWrap.append( '<ul>' + booksHTML + '</ul>' );\n\t\t\t}\n\n\t\t} ).catch( function( errorMessage ) {\n\t\t\tBDB_Post_Metabox.errorWrap.append( errorMessage ).show();\n\t\t} ).finally( function() {\n\t\t\tunspinButton( button );\n\t\t} );\n\n\t},\n\n\t/**\n\t * Select a book to review\n\t *\n\t * @param e\n\t */\n\tselectBook: function ( e ) {\n\n\t\te.preventDefault();\n\n\t\t// Set the book ID.\n\t\tBDB_Post_Metabox.bookID = $( this ).data( 'id' );\n\n\t\t// Wipe the search results.\n\t\tBDB_Post_Metabox.searchResultsWrap.empty().append( '<p>' + bdbVars.please_wait + '</p>' );\n\n\t\tlet args = {\n\t\t\tbook_id: $( this ).data( 'id' )\n\t\t};\n\n\t\t// Get reading logs.\n\t\tapiRequest( 'v1/reading-log', args, 'GET' ).then( function( apiResponse ) {\n\n\t\t\tlet logOptions = $( '#bdb-review-reading-log' );\n\n\t\t\tif ( apiResponse.length > 0 ) {\n\t\t\t\t$.each( apiResponse, function( key, log ) {\n\t\t\t\t\tlogOptions.append( '<option value=\"' + log.id + '\">' + BDB_Post_Metabox.shapeLog( log ) + '</option>' );\n\t\t\t\t} )\n\t\t\t}\n\n\t\t\t// Wipe the search results again.\n\t\t\tBDB_Post_Metabox.searchResultsWrap.empty();\n\n\t\t\t// Show the log selection.\n\t\t\t$( '#bdb-add-review-fields' ).show();\n\n\t\t} ).catch( function( errorMessage ) {\n\t\t\tBDB_Post_Metabox.errorWrap.append( errorMessage ).show();\n\t\t} );\n\n\t},\n\n\t/**\n\t * Shape the reading log entry for display in an `<option>`\n\t *\n\t * @param {object} readingLog\n\t * @returns {string}\n\t */\n\tshapeLog: function ( readingLog ) {\n\n\t\treadingLog.date_started_formatted  = dateUTCtoLocal( readingLog.date_started, 'display' );\n\t\treadingLog.date_finished_formatted = dateUTCtoLocal( readingLog.date_finished, 'display' );\n\t\treadingLog.rating                  = null === readingLog.rating ? null : parseFloat( readingLog.rating ) + ' ' + bdbVars.stars;\n\n\t\tif ( ! readingLog.date_started_formatted ) {\n\t\t\treadingLog.date_started_formatted = '(' + bdbVars.unknown + ')';\n\t\t}\n\t\tif ( ! readingLog.date_finished_formatted ) {\n\t\t\treadingLog.date_finished_formatted = '(' + bdbVars.unknown + ')';\n\t\t}\n\n\t\treturn readingLog.date_started_formatted + ' - ' + readingLog.date_finished_formatted + ' (' + readingLog.rating + ')';\n\n\t},\n\n\t/**\n\t * Add a new review\n\t *\n\t * @param e\n\t */\n\taddReview: function ( e ) {\n\n\t\te.preventDefault();\n\n\t\tlet button = $( this );\n\n\t\tspinButton( button );\n\n\t\tlet args = {\n\t\t\tbook_id: BDB_Post_Metabox.bookID,\n\t\t\treading_log_id: $( '#bdb-review-reading-log' ).val(),\n\t\t\tuser_id: BDB_Post_Metabox.userID,\n\t\t\tpost_id: BDB_Post_Metabox.postID\n\t\t};\n\n\t\tapiRequest( 'v1/review/add', args, 'POST' ).then( function( apiResponse ) {\n\n\t\t\tlet args = {\n\t\t\t\trating_format: 'text',\n\t\t\t\treview_query: [ {\n\t\t\t\t\tfield: 'id',\n\t\t\t\t\tvalue: apiResponse.id\n\t\t\t\t} ]\n\t\t\t};\n\n\t\t\treturn apiRequest( 'v1/reviews', args, 'GET' );\n\n\t\t} ).then( function( apiResponse ) {\n\n\t\t\t// Add the review(s) to the table.\n\t\t\t$.each( apiResponse, function( key, review ) {\n\t\t\t\t$( '#bdb-no-post-reviews' ).remove();\n\t\t\t\tBDB_Post_Metabox.tableBody.append( wp.template( 'bdb-table-post-reviews-row' )( review ) );\n\t\t\t} );\n\n\t\t\t// Hide the log selection.\n\t\t\t$( '#bdb-add-review-fields' ).hide();\n\n\t\t} ).catch( function( errorMessage ) {\n\t\t\tBDB_Post_Metabox.errorWrap.append( errorMessage ).show();\n\t\t} ).finally( function() {\n\t\t\tunspinButton( button );\n\t\t} );\n\n\t},\n\n\t/**\n\t * Disassociate a review from this post\n\t *\n\t * @param e\n\t * @returns {boolean}\n\t */\n\tdisassociateReview: function ( e ) {\n\n\t\te.preventDefault();\n\n\t\tif ( ! confirm( bdbVars.confirm_remove_review_association ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet button = $( this );\n\n\t\tspinButton( button );\n\n\t\tBDB_Post_Metabox.errorWrap.empty().hide();\n\n\t\tlet wrap = button.closest( 'tr' );\n\n\t\tlet args = {\n\t\t\tpost_id: null\n\t\t};\n\n\t\tapiRequest( 'v1/review/update/' + wrap.data( 'id' ), args, 'POST' ).then( function( apiResponse ) {\n\t\t\twrap.remove();\n\t\t} ).catch( function( errorMessage ) {\n\t\t\tBDB_Post_Metabox.errorWrap.append( errorMessage ).show();\n\t\t} ).finally( function() {\n\t\t\tunspinButton( button );\n\t\t} );\n\n\t},\n\n\t/**\n\t * Delete a review\n\t *\n\t * @param e\n\t * @returns {boolean}\n\t */\n\tdeleteReview: function ( e ) {\n\n\t\te.preventDefault();\n\n\t\tif ( ! confirm( bdbVars.confirm_delete_review ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet button = $( this );\n\n\t\tspinButton( button );\n\n\t\tBDB_Post_Metabox.errorWrap.empty().hide();\n\n\t\tlet wrap = button.closest( 'tr' );\n\n\t\tlet args = {\n\t\t\tpost_id: null\n\t\t};\n\n\t\tapiRequest( 'v1/review/delete/' + wrap.data( 'id' ), args, 'DELETE' ).then( function( apiResponse ) {\n\t\t\twrap.remove();\n\t\t} ).catch( function( errorMessage ) {\n\t\t\tBDB_Post_Metabox.errorWrap.append( errorMessage ).show();\n\t\t} ).finally( function() {\n\t\t\tunspinButton( button );\n\t\t} );\n\n\t}\n\n};\n\nexport { BDB_Post_Metabox }","/**\n * Admin Global Scripts\n *\n * We have a separate file here because this one is loaded on non-BDB pages and we want\n * to avoid loading *all* our plugin JS on such \"public\" pages like that.\n *\n * @package book-database\n * @copyright Copyright (c) 2019, Ashley Gibson\n * @license GPL2+\n */\n\nimport { BDB_Dashboard_Widgets } from \"./modules/dashboard-widgets\";\nimport { BDB_Post_Metabox } from \"./modules/post-metabox\";\n\n( function ( $ ) {\n\n\tBDB_Dashboard_Widgets.init();\n\tBDB_Post_Metabox.init();\n\n} )( jQuery );"],"sourceRoot":""}