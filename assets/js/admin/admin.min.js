jQuery(function($){var bookDatabaseFrame;$(".bookdb-upload-image").on("click",function(event){var self=$(this),imageField=$(this).parent().data("image"),imageIDField=$(this).parent().data("image-id"),imageSize=$(this).parent().data("image-size");if(!imageSize||"undefined"===typeof imageSize){imageSize="medium"}event.preventDefault();bookDatabaseFrame=wp.media.frames.bookDB=wp.media({title:self.data("choose"),button:{text:self.data("update")},states:[new wp.media.controller.Library({title:self.data("choose"),filterable:"all",multiple:false})]});bookDatabaseFrame.on("select",function(){var selection=bookDatabaseFrame.state().get("selection");selection.map(function(attachment){attachment=attachment.toJSON();if(attachment.id){$(imageIDField).val(attachment.id);var attachmentImage=attachment.sizes&&attachment.sizes[imageSize]?attachment.sizes[imageSize].url:attachment.url;if(typeof $(imageIDField).attributes!="undefined"){while($(imageIDField).attributes.length>0){elem.removeAttribute(elem.attributes[0].name)}}$(imageField).attr("src",attachmentImage).attr("alt",attachment.alt).show();self.parent().find(".bookdb-remove-image").show()}})});bookDatabaseFrame.open()});$(".bookdb-remove-image").on("click",function(){var self=$(this),imageField=$(this).parent().data("image"),imageIDField=$(this).parent().data("image-id");if(typeof $(imageField).attributes!="undefined"){while($(imageField).attributes.length>0){elem.removeAttribute(elem.attributes[0].name)}}$(imageField).hide();$(imageIDField).val("");self.hide();return false})});