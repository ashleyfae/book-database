{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./assets/js/src/admin/index.js","webpack:///./assets/js/src/admin/modules/book-index-title.js","webpack:///./assets/js/src/admin/modules/book-layout.js","webpack:///./assets/js/src/admin/modules/categories.js","webpack:///./assets/js/src/admin/modules/delete-objects.js","webpack:///./assets/js/src/admin/modules/editions.js","webpack:///./assets/js/src/admin/modules/media-upload.js","webpack:///./assets/js/src/admin/modules/tags.js","webpack:///./assets/js/src/admin/modules/taxonomies.js","webpack:///./assets/js/src/utils/api-request.js","webpack:///./assets/js/src/utils/index.js","webpack:///./assets/js/src/utils/loaders.js","webpack:///external \"jQuery\""],"names":["$","BDB_Book_Layout","init","BDB_Book_Index_Title","BDB_Categories","BDB_Delete_Objects","BDB_Editions","BDB_Media","BDB_Tags","BDB_Book_Taxonomies","jQuery","bookTitleField","indexTitleSelect","indexTitleCustomField","on","toggleCustomIndexTitle","trigger","writeOriginalTitle","populateIndexTitles","selectedIndexTitle","val","slideDown","css","slideUp","find","text","args","title","apiRequest","then","response","after","catch","error","console","log","toggleBookTextarea","changeCoverAlignment","sort","e","next","slideToggle","parentDiv","removeClass","index","match","join","addClass","sortable","cancel","connectWith","placeholder","update","event","ui","parentID","item","parent","attr","disabledIndicator","hasClass","addCheckboxTerm","type","preventDefault","which","wrap","closest","checkboxName","data","checkboxTaxonomy","checkboxWrap","newTerm","elID","createID","append","value","prefix","replace","s","c","charCodeAt","toLowerCase","toString","slice","confirm","message","bdbVars","bookID","tableBody","rowTemplate","wp","template","rowEmptyTemplate","errorWrap","length","toggleNewEditionFields","addEdition","document","toggleEditableFields","updateEdition","removeEdition","getEditions","book_id","empty","remove","each","key","edition","show","button","spinButton","hide","isbn","format","date_acquired","source_id","signed","prop","date","dateResponse","newFieldsWrap","errorMessage","finally","unspinButton","apiResponse","replaceWith","confirm_delete_edition","frame","createFrame","removeImage","imageField","imageIDField","imageSize","media","frames","bookDB","states","controller","Library","filterable","multiple","selection","state","get","map","attachment","toJSON","id","attachmentImage","sizes","url","attributes","elem","removeAttribute","name","alt","open","tag","quickClicks","flushTags","newTag","taxonomy","apiURL","api_base","api_nonce","suggest","clean","tags","parseTags","el","num","split","tagBox","theTags","currentTags","newTags","trim","push","tagChecklist","disabled","span","xbutton","prepend","a","f","tagsVal","uniqueArray","focus","array","out","inArray","generateSlug","addTaxonomy","updateTaxonomy","deleteTaxonomy","getTaxonomies","slug","checkRequiredFields","requirementsResponse","confirm_delete_taxonomy","Promise","resolve","reject","hasOwnProperty","error_required_fields","endpoint","method","options","beforeSend","xhr","setRequestHeader","xhrFields","withCredentials","ajax","success","qpXHR","textStatus","errorThrown","generic_erroc","responseJSON","newText","is_admin","please_wait","html"],"mappings":"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","file":"assets/js/build/admin.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./assets/js/src/admin/index.js\");\n","/**\r\n * Admin Scripts\r\n *\r\n * @package book-database\r\n * @copyright Copyright (c) 2019, Ashley Gibson\r\n * @license GPL2+\r\n */\r\n\r\nimport { BDB_Book_Layout } from './modules/book-layout.js';\r\nimport { BDB_Book_Index_Title } from './modules/book-index-title';\r\nimport { BDB_Categories } from \"./modules/categories\";\r\nimport { BDB_Delete_Objects } from \"./modules/delete-objects\";\r\nimport { BDB_Editions } from \"./modules/editions\";\r\nimport { BDB_Media } from \"./modules/media-upload\";\r\nimport { BDB_Tags } from './modules/tags';\r\nimport { BDB_Book_Taxonomies } from './modules/taxonomies.js';\r\n\r\n( function ( $ ) {\r\n\r\n\tBDB_Book_Layout.init();\r\n\tBDB_Book_Index_Title.init();\r\n\tBDB_Categories.init();\r\n\tBDB_Delete_Objects.init();\r\n\tBDB_Editions.init();\r\n\tBDB_Media.init();\r\n\tBDB_Tags.init();\r\n\tBDB_Book_Taxonomies.init();\r\n\r\n} )( jQuery );","/* global $, bdbVars, wp */\r\n\r\nimport { apiRequest, spinButton, unspinButton } from 'utils';\r\n\r\nvar BDB_Book_Index_Title = {\r\n\r\n\tbookTitleField: false,\r\n\r\n\tindexTitleSelect: false,\r\n\r\n\tindexTitleCustomField: false,\r\n\r\n\t/**\r\n\t * Initialize\r\n\t */\r\n\tinit: function() {\r\n\r\n\t\tthis.bookTitleField = $( '#bdb-book-title' );\r\n\t\tthis.indexTitleSelect = $( '#bdb-book-index-title' );\r\n\t\tthis.indexTitleCustomField = $( '#bdb-book-index-title-custom' );\r\n\r\n\t\tthis.indexTitleSelect.on( 'change', this.toggleCustomIndexTitle ).trigger( 'change' );\r\n\t\tthis.bookTitleField.on( 'keyup', this.writeOriginalTitle );\r\n\t\tthis.bookTitleField.on( 'blur', this.populateIndexTitles );\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Show the \"Custom\" box if \"Custom\" is selected. Otherwise, hide it.\r\n\t */\r\n\ttoggleCustomIndexTitle: function () {\r\n\r\n\t\tlet selectedIndexTitle = $( this ).val();\r\n\r\n\t\tif ( 'custom' === selectedIndexTitle ) {\r\n\t\t\tBDB_Book_Index_Title.indexTitleCustomField.slideDown().css( 'display', 'block' );\r\n\t\t} else {\r\n\t\t\tBDB_Book_Index_Title.indexTitleCustomField.slideUp();\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Copies the contents of the original \"Book Title\" field to the \"original\" index title option.\r\n\t */\r\n\twriteOriginalTitle: function () {\r\n\t\tBDB_Book_Index_Title.indexTitleSelect.find( 'option[value=\"original\"]' ).text( $( this ).val() );\r\n\t},\r\n\r\n\t/**\r\n\t * Create an index-friendly version of the entered book title and insert it as an\r\n\t * option in the <select> dropdown.\r\n\t */\r\n\tpopulateIndexTitles: function () {\r\n\r\n\t\tlet args = {\r\n\t\t\ttitle: $( this ).val()\r\n\t\t};\r\n\r\n\t\tapiRequest( 'v1/book/index-title', args, 'GET' ).then( function( response ) {\r\n\t\t\tBDB_Book_Index_Title.indexTitleSelect.find( 'option[value=\"original\"]' ).after( '<option value=\"' + response + '\">' + response + '</option>' );\r\n\t\t} ).catch( function( error ) {\r\n\t\t\tconsole.log( 'Index title generation error', error );\r\n\t\t} );\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport { BDB_Book_Index_Title }","/* global $, bdbVars, wp */\r\n\r\n/**\r\n * Book Layout\r\n */\r\nvar BDB_Book_Layout = {\r\n\r\n\t/**\r\n\t * Initialize\r\n\t */\r\n\tinit: function() {\r\n\t\t$( '.bdb-book-option-toggle' ).on( 'click', this.toggleBookTextarea );\r\n\t\t$( '#bdb-book-layout-cover-changer' ).on( 'change', this.changeCoverAlignment );\r\n\r\n\t\tthis.sort();\r\n\t},\r\n\r\n\t/**\r\n\t * Toggle the book textarea\r\n\t *\r\n\t * @param e\r\n\t */\r\n\ttoggleBookTextarea: function( e ) {\r\n\t\t$( this ).next().slideToggle();\r\n\t},\r\n\r\n\t/**\r\n\t * Change the real-time alignment of the book coversss123\r\n\t *\r\n\t * @param e\r\n\t */\r\n\tchangeCoverAlignment: function ( e ) {\r\n\t\tlet parentDiv = $( '#bdb-book-option-cover' );\r\n\r\n\t\tparentDiv.removeClass( function ( index, css ) {\r\n\t\t\treturn ( css.match(/(^|\\s)bdb-book-cover-align-\\S+/g) || [] ).join(' ');\r\n\t\t} ).addClass( 'bdb-book-cover-align-' + $( this ).val() );\r\n\t},\r\n\r\n\tsort: function() {\r\n\t\t$( '.bdb-sortable' ).sortable( {\r\n\t\t\tcancel: '.bdb-no-sort, textarea, input, select',\r\n\t\t\tconnectWith: '.bdb-sortable',\r\n\t\t\tplaceholder: 'bdb-sortable-placeholder',\r\n\t\t\tupdate: function ( event, ui ) {\r\n\t\t\t\tlet parentID = ui.item.parent().attr( 'id' );\r\n\t\t\t\tlet disabledIndicator = ui.item.find( '.bdb-book-option-disabled' );\r\n\t\t\t\tif ( $( '#' + parentID ).hasClass( 'bdb-sorter-enabled-column' ) ) {\r\n\t\t\t\t\tdisabledIndicator.val( 'false' );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdisabledIndicator.val( 'true' );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} )\r\n\t}\r\n\r\n};\r\n\r\nexport { BDB_Book_Layout };","/* global $, bdbVars, wp */\r\n\r\n/**\r\n * Category style checkboxes\r\n */\r\nvar BDB_Categories = {\r\n\r\n\t/**\r\n\t * Initialize\r\n\t */\r\n\tinit: function() {\r\n\r\n\t\t$( '.bdb-new-checkbox-term' ).on( 'click', '.button', this.addCheckboxTerm );\r\n\t\t$( '.bdb-new-checkbox-term-value' ).on( 'keypress', this.addCheckboxTerm );\r\n\r\n\t},\r\n\r\n\taddCheckboxTerm: function ( e ) {\r\n\r\n\t\tif ( 'click' === e.type ) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\tif ( 'keypress' === e.type && 13 !== e.which ) {\r\n\t\t\treturn true;\r\n\t\t} else {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\tlet wrap = $( this ).closest( '.bdb-taxonomy-checkboxes' ),\r\n\t\t\tcheckboxName = wrap.data( 'name' ),\r\n\t\t\tcheckboxTaxonomy = wrap.data( 'taxonomy' ),\r\n\t\t\tcheckboxWrap = wrap.find( '.bdb-checkbox-wrap' ),\r\n\t\t\tnewTerm = wrap.find( '.bdb-new-checkbox-term-value' ),\r\n\t\t\telID = BDB_Categories.createID( newTerm.val(), checkboxTaxonomy + '-' );\r\n\r\n\t\tcheckboxWrap.append( '<label for=\"' + elID + '\"><input type=\"checkbox\" id=\"' + elID + '\" name=\"' + checkboxName + '\" class=\"bdb\" value=\"' + newTerm.val() + '\" checked=\"checked\"> ' + newTerm.val() + '</label>' );\r\n\r\n\t\tnewTerm.val( '' );\r\n\r\n\t},\r\n\r\n\tcreateID: function ( value, prefix ) {\r\n\r\n\t\treturn value.replace( /[^a-z0-9]/g, function( s ) {\r\n\t\t\tlet c = s.charCodeAt( 0 );\r\n\r\n\t\t\tif ( 32 === c ) {\r\n\t\t\t\treturn '-';\r\n\t\t\t}\r\n\r\n\t\t\tif ( c >= 65 && c <= 90 ) {\r\n\t\t\t\treturn prefix + s.toLowerCase();\r\n\t\t\t}\r\n\r\n\t\t\treturn prefix + ( '000' + c.toString( 16 ) ).slice( -4 );\r\n\t\t} );\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport { BDB_Categories }","/* global $, bdbVars, wp */\r\n\r\n/**\r\n * Confirmation when deleting objects\r\n */\r\nvar BDB_Delete_Objects = {\r\n\r\n\t/**\r\n\t * Initialize\r\n\t */\r\n\tinit: function() {\r\n\t\t$( '.bdb-delete-item' ).on( 'click', this.confirm );\r\n\t},\r\n\r\n\t/**\r\n\t * Confirm deleting the item\r\n\t *\r\n\t * @param e\r\n\t * @returns {boolean}\r\n\t */\r\n\tconfirm: function( e ) {\r\n\t\tlet type = $( this ).data( 'object' );\r\n\t\tlet message = bdbVars['confirm_delete_' + type];\r\n\r\n\t\tif ( ! confirm( message ) ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n};\r\n\r\nexport { BDB_Delete_Objects }","/* global $, bdbVars, wp */\r\n\r\nimport { apiRequest, spinButton, unspinButton } from 'utils';\r\n\r\n/**\r\n * Editions\r\n */\r\nvar BDB_Editions = {\r\n\r\n\tbookID: 0,\r\n\r\n\ttableBody: false,\r\n\r\n\trowTemplate: wp.template( 'bdb-editions-table-row' ),\r\n\r\n\trowEmptyTemplate: wp.template( 'bdb-editions-table-row-empty' ),\r\n\r\n\terrorWrap: '',\r\n\r\n\t/**\r\n\t * Initialize\r\n\t */\r\n\tinit: function() {\r\n\r\n\t\tthis.bookID    = $( '#bdb-book-id' ).val();\r\n\t\tthis.tableBody = $( '#bdb-book-editions-list .wp-list-table tbody' );\r\n\t\tthis.errorWrap = $( '#bdb-editions-errors' );\r\n\r\n\t\tif ( ! this.tableBody.length || 'undefined' === typeof this.bookID || ! this.bookID ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t$( '#bdb-add-edition' ).on( 'click', this.toggleNewEditionFields );\r\n\t\t$( '#bdb-submit-new-edition' ).on( 'click', this.addEdition );\r\n\t\t$( document ).on( 'click', '.bdb-edition-toggle-editable', this.toggleEditableFields );\r\n\t\t$( document ).on( 'click', '.bdb-update-edition', this.updateEdition );\r\n\t\t$( document ).on( 'click', '.bdb-remove-edition', this.removeEdition );\r\n\r\n\t\tthis.getEditions();\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Get the editions\r\n\t */\r\n\tgetEditions: function() {\r\n\r\n\t\tapiRequest( 'v1/edition', { book_id: BDB_Editions.bookID }, 'GET' ).then( function( response ) {\r\n\r\n\t\t\tBDB_Editions.tableBody.empty();\r\n\r\n\t\t\tif ( 0 === response.length || 'undefined' === typeof response.length ) {\r\n\t\t\t\tBDB_Editions.tableBody.append( BDB_Editions.rowEmptyTemplate );\r\n\t\t\t} else {\r\n\t\t\t\t$( '#bdb-book-editions-empty' ).remove();\r\n\t\t\t\t$.each( response, function( key, edition ) {\r\n\t\t\t\t\tBDB_Editions.tableBody.append( BDB_Editions.rowTemplate( edition ) );\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\r\n\t\t} ).catch( function( error ) {\r\n\t\t\tBDB_Editions.errorWrap.empty().append( error ).show();\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Toggle the new edition fields\r\n\t *\r\n\t * @param e\r\n\t */\r\n\ttoggleNewEditionFields: function ( e ) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\t$( '#bdb-new-edition-fields' ).slideToggle();\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Add a new edition\r\n\t *\r\n\t * @param e\r\n\t */\r\n\taddEdition: function ( e ) {\r\n\r\n\t\te.preventDefault();\r\n\t\tlet button = $( this );\r\n\r\n\t\tspinButton( button );\r\n\t\tBDB_Editions.errorWrap.empty().hide();\r\n\r\n\t\tlet args = {\r\n\t\t\tbook_id: $( '#bdb-book-id' ).val(),\r\n\t\t\tisbn: $( '#bdb-new-edition-isbn' ).val(),\r\n\t\t\tformat: $( '#bdb-new-edition-format' ).val(),\r\n\t\t\tdate_acquired: $( '#bdb-new-edition-date-acquired' ).val(),\r\n\t\t\tsource_id: $( '#bdb-checkboxes-source-edition' ).find( 'input:checked' ).val(),\r\n\t\t\tsigned: $( '#bdb-new-edition-signed' ).prop( 'checked' )\r\n\t\t};\r\n\r\n\t\tapiRequest( 'v1/utility/convert-date', { date: args.date_acquired }, 'POST' ).then( function( dateResponse ) {\r\n\t\t\targs.date_acquired = dateResponse;\r\n\r\n\t\t\tconsole.log(args);\r\n\r\n\t\t\treturn apiRequest( 'v1/edition/add', args, 'POST' );\r\n\t\t} ).then( function( response ) {\r\n\r\n\t\t\t$( '#bdb-book-editions-empty' ).remove();\r\n\t\t\tBDB_Editions.tableBody.append( BDB_Editions.rowTemplate( response ) );\r\n\r\n\t\t\t// Wipe new field values.\r\n\t\t\tlet newFieldsWrap = $( '#bdb-new-edition-fields' );\r\n\t\t\tnewFieldsWrap.find( 'input[type=\"text\"]' ).val( '' );\r\n\t\t\tnewFieldsWrap.find( 'input[type=\"checkbox\"]' ).prop( 'checked', false );\r\n\r\n\t\t} ).catch( function( errorMessage ) {\r\n\t\t\tBDB_Editions.errorWrap.append( errorMessage ).show();\r\n\t\t} ).finally( function() {\r\n\t\t\tunspinButton( button );\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Toggle the editable edition fields\r\n\t *\r\n\t * @param e\r\n\t */\r\n\ttoggleEditableFields: function ( e ) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tlet button = $( this );\r\n\t\tlet wrap = button.closest( 'tr' );\r\n\r\n\t\twrap.find( '.bdb-table-display-value' ).hide();\r\n\t\twrap.find( '.bdb-table-edit-value' ).show();\r\n\r\n\t\tbutton.removeClass( 'bdb-edition-toggle-editable' ).addClass( 'bdb-update-edition button-primary' ).text( 'Save' );\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Update an edition\r\n\t *\r\n\t * @param e\r\n\t */\r\n\tupdateEdition: function ( e ) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tlet button = $( this );\r\n\r\n\t\tspinButton( button );\r\n\t\tBDB_Editions.errorWrap.empty().hide();\r\n\r\n\t\tlet wrap = button.closest( 'tr' );\r\n\r\n\t\tlet args = {\r\n\t\t\tisbn: wrap.find( '.bdb-edition-isbn input' ).val(),\r\n\t\t\tformat: wrap.find( '.bdb-edition-format select' ).val(),\r\n\t\t\tdate_acquired: wrap.find( '.bdb-edition-date-acquired input' ).val(),\r\n\t\t\tsource_id: wrap.find( '.bdb-edition-source select' ).val(),\r\n\t\t\tsigned: wrap.find( '.bdb-edition-signed input[type=\"checkbox\"]' ).prop( 'checked' )\r\n\t\t};\r\n\r\n\t\tapiRequest( 'v1/utility/convert-date', { date: args.date_acquired }, 'POST' ).then( function( dateResponse ) {\r\n\t\t\targs.date_acquired = dateResponse;\r\n\r\n\t\t\treturn apiRequest( 'v1/edition/update/' + wrap.data( 'id' ), args, 'POST' );\r\n\t\t} ).then( function( apiResponse ) {\r\n\t\t\twrap.replaceWith( BDB_Editions.rowTemplate( apiResponse ) );\r\n\t\t} ).catch( function( errorMessage ) {\r\n\t\t\tBDB_Editions.errorWrap.append( errorMessage ).show();\r\n\t\t} ).finally( function() {\r\n\t\t\tunspinButton( button );\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Delete an edition\r\n\t *\r\n\t * @param e\r\n\t * @returns {boolean}\r\n\t */\r\n\tremoveEdition: function ( e ) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tif ( ! confirm( bdbVars.confirm_delete_edition ) ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tlet button = $( this );\r\n\r\n\t\tspinButton( button );\r\n\t\tBDB_Editions.errorWrap.empty().hide();\r\n\r\n\t\tlet wrap = button.closest( 'tr' );\r\n\r\n\t\tapiRequest( 'v1/edition/delete/' + wrap.data( 'id' ), {}, 'DELETE' ).then( function( apiResponse ) {\r\n\t\t\twrap.remove();\r\n\t\t} ).catch( function( errorMessage ) {\r\n\t\t\tBDB_Editions.errorWrap.append( errorMessage ).show();\r\n\t\t} ).finally( function() {\r\n\t\t\tunspinButton( button );\r\n\t\t} );\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport { BDB_Editions }","/* global $, bdbVars, wp */\r\n\r\n/**\r\n * Interface with the WP media modal\r\n */\r\nvar BDB_Media = {\r\n\r\n\tframe: false,\r\n\r\n\t/**\r\n\t * Initialize\r\n\t */\r\n\tinit: function() {\r\n\t\t$( '.bdb-upload-image' ).on( 'click', this.createFrame );\r\n\t\t$( '.bdb-remove-image' ).on( 'click', this.removeImage );\r\n\t},\r\n\r\n\t/**\r\n\t * Create and open the media frame\r\n\t *\r\n\t * @param e\r\n\t */\r\n\tcreateFrame: function( e ) {\r\n\t\te.preventDefault();\r\n\r\n\t\tlet button = $( this ),\r\n\t\t\timageField = $( this ).parent().data( 'image' ),\r\n\t\t\timageIDField = $( this ).parent().data( 'image-id' ),\r\n\t\t\timageSize = $( this ).parent().data( 'image-size' );\r\n\r\n\t\tif ( ! imageSize || 'undefined' === typeof imageSize ) {\r\n\t\t\timageSize = 'medium';\r\n\t\t}\r\n\r\n\t\t// Create the media frame.\r\n\t\tBDB_Media.frame = wp.media.frames.bookDB = wp.media( {\r\n\t\t\ttitle: button.data( 'choose' ),\r\n\t\t\tbutton: {\r\n\t\t\t\ttext: button.data( 'update' )\r\n\t\t\t},\r\n\t\t\tstates: [\r\n\t\t\t\tnew wp.media.controller.Library( {\r\n\t\t\t\t\ttitle: button.data( 'choose' ),\r\n\t\t\t\t\tfilterable: 'all',\r\n\t\t\t\t\tmultiple: false\r\n\t\t\t\t} )\r\n\t\t\t]\r\n\t\t} );\r\n\r\n\t\t// When an image is selected, run a callback.\r\n\t\tBDB_Media.frame.on( 'select', function() {\r\n\t\t\tlet selection = BDB_Media.frame.state().get( 'selection' );\r\n\r\n\t\t\tselection.map( function( attachment ) {\r\n\t\t\t\tattachment = attachment.toJSON();\r\n\r\n\t\t\t\tif ( attachment.id ) {\r\n\t\t\t\t\t$( imageIDField ).val( attachment.id );\r\n\r\n\t\t\t\t\tlet attachmentImage = attachment.sizes && attachment.sizes[imageSize] ? attachment.sizes[imageSize].url : attachment.url;\r\n\r\n\t\t\t\t\t// Remove all image attributes.\r\n\t\t\t\t\tif ( 'undefined' !== typeof $( imageField ).attributes ) {\r\n\t\t\t\t\t\twhile ( $( imageField ).attributes.length > 0 ) {\r\n\t\t\t\t\t\t\telem.removeAttribute( elem.attributes[0].name );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Update image src and alt text, then show image.\r\n\t\t\t\t\t$( imageField ).attr( 'src', attachmentImage ).attr( 'alt', attachment.alt ).show();\r\n\r\n\t\t\t\t\t// Show remove button.\r\n\t\t\t\t\tbutton.parent().find( '.bdb-remove-image' ).show();\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t} );\r\n\r\n\t\t// Finally, open the modal.\r\n\t\tBDB_Media.frame.open();\r\n\t},\r\n\r\n\t/**\r\n\t * Remove the chosen image\r\n\t *\r\n\t * @param e\r\n\t */\r\n\tremoveImage: function ( e ) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tlet button = $( this ),\r\n\t\t\timageField = button.parent().data( 'image' ),\r\n\t\t\timageIDField = button.parent().data( 'image-id' );\r\n\r\n\t\t// Remove image attributes and hide.\r\n\t\tif ( 'undefined' !== typeof $( imageField ).attributes ) {\r\n\t\t\twhile ( $( imageField ).attributes.length > 0 ) {\r\n\t\t\t\telem.removeAttribute( elem.attributes[0].name );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t$( imageField ).hide();\r\n\r\n\t\t// Delete image ID value.\r\n\t\t$( imageIDField ).val( '' );\r\n\r\n\t\t// Now hide the remove button.\r\n\t\tbutton.hide();\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport { BDB_Media }","/* global $, bdbVars, wp */\r\n\r\n/**\r\n * Autocomplete for tags\r\n */\r\nvar BDB_Tags = {\r\n\r\n\ttag: false,\r\n\r\n\t/**\r\n\t * Initialize\r\n\t */\r\n\tinit: function() {\r\n\r\n\t\tthis.tag = $( '.bdb-ajaxtag' );\r\n\r\n\t\tif ( ! this.tag.length ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t$( '.bdb-tags-wrap' ).each( function() {\r\n\t\t\tBDB_Tags.quickClicks( $( this ) );\r\n\t\t} );\r\n\r\n\t\t$( '.button', BDB_Tags.tag ).on( 'click', function() {\r\n\t\t\tBDB_Tags.flushTags( $( this ).closest( '.bdb-tags-wrap' ) );\r\n\t\t} );\r\n\r\n\t\tBDB_Tags.tag.each( function() {\r\n\t\t\tlet newTag = $( '.bdb-new-tag', $( this ) );\r\n\t\t\tlet taxonomy = $( this ).closest( '.bdb-tags-wrap' ).data( 'taxonomy' );\r\n\t\t\tlet apiURL = bdbVars.api_base + 'book-database/v1/book-term/suggest/?taxonomy=' + taxonomy + '&format=text&_wpnonce=' + bdbVars.api_nonce;\r\n\r\n\t\t\tif ( 'author' === taxonomy ) {\r\n\t\t\t\tapiURL = bdbVars.api_base + 'book-database/v1/author/suggest/?format=text&_wpnonce=' + bdbVars.api_nonce;\r\n\t\t\t}\r\n\r\n\t\t\tnewTag.on( 'keyup', function( e ) {\r\n\t\t\t\tif ( 13 === e.which ) {\r\n\t\t\t\t\tBDB_Tags.flushTags( $( this ).closest( '.bdb-tags-wrap' ) );\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t} ).on( 'keypress', function( e ) {\r\n\t\t\t\tif ( 13 === e.which ) {\r\n\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t} ).suggest( apiURL );\r\n\t\t} );\r\n\r\n\t\t$( '#bdb-book-series-name' ).suggest( bdbVars.api_base + 'book-database/v1/series/suggest/?format=text&_wpnonce=' + bdbVars.api_nonce );\r\n\r\n\t\t// Save tags on save/publish\r\n\t\t$( '.bdb-admin-page > form' ).on( 'submit', function( e ) {\r\n\t\t\t$( '.bdb-tags-wrap' ).each( function() {\r\n\t\t\t\tBDB_Tags.flushTags( this, false, 1 );\r\n\t\t\t} );\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Clean tags\r\n\t *\r\n\t * @param tags\r\n\t */\r\n\tclean: function ( tags ) {\r\n\t\treturn tags.replace( /\\s*,\\s*/g, ',' ).replace( /,+/g, ',' ).replace( /[,\\s]+$/, '' ).replace( /^[,\\s]+/, '' );\r\n\t},\r\n\r\n\t/**\r\n\t * Parse tags\r\n\t *\r\n\t * @param el\r\n\t */\r\n\tparseTags: function ( el ) {\r\n\r\n\t\tlet id = el.id;\r\n\t\tlet num = id.split( '-check-num-' )[ 1 ];\r\n\t\tlet tagBox = $( el ).closest( '.bdb-tags-wrap' );\r\n\t\tlet theTags = tagBox.find( 'textarea' );\r\n\t\tlet currentTags = theTags.val().split( ',' );\r\n\t\tlet newTags = [];\r\n\r\n\t\tdelete currentTags[ num ];\r\n\r\n\t\t$.each( currentTags, function ( key, val ) {\r\n\t\t\tval = $.trim( val );\r\n\r\n\t\t\tif ( val ) {\r\n\t\t\t\tnewTags.push( val );\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\ttheTags.val( BDB_Tags.clean( newTags.join( ',' ) ) );\r\n\r\n\t\tBDB_Tags.quickClicks( tagBox );\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Handles adding tags\r\n\t *\r\n\t * @param el\r\n\t */\r\n\tquickClicks: function ( el ) {\r\n\r\n\t\tlet theTags = $( 'textarea', el );\r\n\t\tlet tagChecklist = $( '.bdb-tags-checklist', el );\r\n\t\tlet id = $( el ).attr( 'id' );\r\n\t\tlet currentTags;\r\n\t\tlet disabled;\r\n\r\n\t\tif ( ! theTags.length ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tdisabled = theTags.prop( 'disabled' );\r\n\t\tcurrentTags = theTags.val().split( ',' );\r\n\t\ttagChecklist.empty();\r\n\r\n\t\t$.each( currentTags, function( key, val ) {\r\n\t\t\tlet span, xbutton;\r\n\r\n\t\t\tval = $.trim( val );\r\n\r\n\t\t\tif ( ! val ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Create a new span and ensure the text is properly escaped.\r\n\t\t\tspan = $( '<span />' ).text( val );\r\n\r\n\t\t\t// If tags editing isn't disabled, create the X button.\r\n\t\t\tif ( ! disabled ) {\r\n\t\t\t\txbutton = $( '<a id=\"' + id + '-check-num-' + key + '\" class=\"ntdelbutton\">X</a>' );\r\n\t\t\t\txbutton.on( 'click', function( e ) {\r\n\t\t\t\t\tBDB_Tags.parseTags( this );\r\n\t\t\t\t} );\r\n\t\t\t\tspan.prepend( '&nbsp;' ).prepend( xbutton );\r\n\t\t\t}\r\n\r\n\t\t\t// Append the span to the tag list.\r\n\t\t\ttagChecklist.append( span );\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Flush tags on add tag and save\r\n\t *\r\n\t * @param el\r\n\t * @param a\r\n\t * @param f\r\n\t */\r\n\tflushTags: function ( el, a, f ) {\r\n\r\n\t\ta = a || false;\r\n\r\n\t\tlet text;\r\n\t\tlet tags = $( 'textarea', el );\r\n\t\tlet newTag = $( '.bdb-new-tag', el );\r\n\t\tlet tagsVal, newTags;\r\n\r\n\t\ttext = a ? ( a ).text() : newTag.val();\r\n\r\n\t\ttagsVal = tags.val();\r\n\t\tnewTags = tagsVal ? tagsVal + ',' + text : text;\r\n\r\n\t\tnewTags = BDB_Tags.clean( newTags );\r\n\t\tnewTags = BDB_Tags.uniqueArray( newTags.split( ',' ) ).join( ',' );\r\n\r\n\t\ttags.val( newTags );\r\n\t\tBDB_Tags.quickClicks( el );\r\n\r\n\t\tif ( ! a ) {\r\n\t\t\tnewTag.val( '' );\r\n\t\t}\r\n\r\n\t\tif ( 'undefined' === typeof( f ) ) {\r\n\t\t\tnewTag.focus();\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Create a unique array with no empty values\r\n\t *\r\n\t * @param {array} array\r\n\t *\r\n\t * @returns {array}\r\n\t */\r\n\tuniqueArray: function ( array ) {\r\n\r\n\t\tlet out = [];\r\n\r\n\t\t$.each( array, function( key, val ) {\r\n\t\t\tval = $.trim( val );\r\n\r\n\t\t\tif ( val && -1 === $.inArray( val, out ) ) {\r\n\t\t\t\tout.push( val );\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\treturn out;\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport { BDB_Tags }","/* global $, bdbVars, wp */\r\n\r\nimport { apiRequest, spinButton, unspinButton } from 'utils';\r\n\r\n/**\r\n * Book Taxonomies\r\n */\r\nvar BDB_Book_Taxonomies = {\r\n\r\n\ttableBody: false,\r\n\r\n\trowTemplate: wp.template( 'bdb-book-taxonomies-table-row' ),\r\n\r\n\trowEmptyTemplate: wp.template( 'bdb-book-taxonomies-table-row-empty' ),\r\n\r\n\terrorWrap: '',\r\n\r\n\t/**\r\n\t * Initialize\r\n\t */\r\n\tinit: function() {\r\n\r\n\t\tthis.tableBody = $( '#bdb-book-taxonomies tbody' );\r\n\t\tthis.errorWrap = $( '#bdb-book-taxonomies-errors' );\r\n\r\n\t\tif ( ! this.tableBody.length ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t$( '#bdb-new-book-taxonomy-name' ).on( 'keyup', this.generateSlug );\r\n\t\t$( '#bdb-new-book-taxonomy-fields' ).on( 'click', 'button', this.addTaxonomy );\r\n\t\t$( document ).on( 'click', '.bdb-update-book-taxonomy', this.updateTaxonomy );\r\n\t\t$( document ).on( 'click', '.bdb-remove-book-taxonomy', this.deleteTaxonomy );\r\n\r\n\t\tthis.getTaxonomies();\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Get the list of taxonomies\r\n\t */\r\n\tgetTaxonomies: function() {\r\n\r\n\t\tapiRequest( 'v1/taxonomy', {}, 'GET' ).then( function( response ) {\r\n\r\n\t\t\tBDB_Book_Taxonomies.tableBody.empty();\r\n\r\n\t\t\tif ( 0 === response.length || 'undefined' === typeof response.length ) {\r\n\t\t\t\tBDB_Book_Taxonomies.tableBody.append( BDB_Book_Taxonomies.rowEmptyTemplate );\r\n\t\t\t} else {\r\n\t\t\t\t$( '#bdb-book-taxonomies-empty' ).remove();\r\n\t\t\t\t$.each( response, function( key, taxonomy ) {\r\n\t\t\t\t\tBDB_Book_Taxonomies.tableBody.append( BDB_Book_Taxonomies.rowTemplate( taxonomy ) );\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\r\n\t\t} ).catch( function( error ) {\r\n\t\t\tBDB_Book_Taxonomies.errorWrap.empty().append( error ).show();\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Automatically generate a slug from the name\r\n\t *\r\n\t * @param e\r\n\t */\r\n\tgenerateSlug: function ( e ) {\r\n\r\n\t\tlet name = $( '#bdb-new-book-taxonomy-name' ).val();\r\n\t\tlet slug = name.toLowerCase().replace( /[^a-z0-9_\\-]/g, '' );\r\n\r\n\t\t$( '#bdb-new-book-taxonomy-slug' ).val( slug );\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Add a new taxonomy\r\n\t *\r\n\t * @param e\r\n\t */\r\n\taddTaxonomy: function ( e ) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tlet button = $( this );\r\n\r\n\t\tspinButton( button );\r\n\t\tBDB_Book_Taxonomies.errorWrap.empty().hide();\r\n\r\n\t\tlet args = {\r\n\t\t\tname: $( '#bdb-new-book-taxonomy-name' ).val(),\r\n\t\t\tslug: $( '#bdb-new-book-taxonomy-slug' ).val(),\r\n\t\t\tformat: $( '#bdb-new-book-taxonomy-format' ).val()\r\n\t\t};\r\n\r\n\t\tBDB_Book_Taxonomies.checkRequiredFields( args ).then( function( requirementsResponse ) {\r\n\t\t\treturn apiRequest( 'v1/taxonomy/add', args, 'POST' );\r\n\t\t} ).then( function( apiResponse ) {\r\n\t\t\tBDB_Book_Taxonomies.tableBody.append( BDB_Book_Taxonomies.rowTemplate( apiResponse ) );\r\n\r\n\t\t\t// Wipe field values.\r\n\t\t\t$( '#bdb-new-book-taxonomy-fields' ).find( 'input' ).val( '' );\r\n\r\n\t\t\tunspinButton( button );\r\n\t\t} ).catch( function( errorMessage ) {\r\n\t\t\tBDB_Book_Taxonomies.errorWrap.append( errorMessage ).show();\r\n\t\t\tunspinButton( button );\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Update a taxonomy\r\n\t *\r\n\t * @param e\r\n\t */\r\n\tupdateTaxonomy: function ( e ) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tlet button = $( this );\r\n\r\n\t\tspinButton( button );\r\n\t\tBDB_Book_Taxonomies.errorWrap.empty().hide();\r\n\r\n\t\tlet wrap = button.closest( 'tr' );\r\n\r\n\t\tlet args = {\r\n\t\t\tname: wrap.find( '.bdb-book-taxonomy-name input' ).val(),\r\n\t\t\tslug: wrap.find( '.bdb-book-taxonomy-slug input' ).val(),\r\n\t\t\tformat: wrap.find( '.bdb-book-taxonomy-format select' ).val()\r\n\t\t};\r\n\r\n\t\tBDB_Book_Taxonomies.checkRequiredFields( args ).then( function( requirementsResponse ) {\r\n\t\t\treturn apiRequest( 'v1/taxonomy/update/' + wrap.data( 'id' ), args, 'POST' )\r\n\t\t} ).then( function( apiResponse ) {\r\n\t\t\tunspinButton( button );\r\n\t\t} ).catch( function( errorMessage ) {\r\n\t\t\tBDB_Book_Taxonomies.errorWrap.append( errorMessage ).show();\r\n\t\t\tunspinButton( button );\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\tdeleteTaxonomy: function ( e ) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tif ( ! confirm( bdbVars.confirm_delete_taxonomy ) ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tlet button = $( this );\r\n\r\n\t\tspinButton( button );\r\n\t\tBDB_Book_Taxonomies.errorWrap.empty().hide();\r\n\r\n\t\tlet wrap = button.closest( 'tr' );\r\n\r\n\t\tapiRequest( 'v1/taxonomy/delete/' + wrap.data( 'id' ), {}, 'DELETE' ).then( function( apiResponse ) {\r\n\t\t\twrap.remove();\r\n\t\t} ).catch( function( errorMessage ) {\r\n\t\t\tBDB_Book_Taxonomies.errorWrap.append( errorMessage ).show();\r\n\t\t\tunspinButton( button );\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\t/**\r\n\t * Check required fields are filled out\r\n\t *\r\n\t * @param {object} args\r\n\t * @returns {Promise}\r\n\t */\r\n\tcheckRequiredFields: function( args ) {\r\n\r\n\t\treturn new Promise( function( resolve, reject ) {\r\n\r\n\t\t\tif ( ! args.hasOwnProperty( 'name' ) || '' === args.name ) {\r\n\t\t\t\treject( bdbVars.error_required_fields );\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ( ! args.hasOwnProperty( 'slug' ) || '' === args.slug ) {\r\n\t\t\t\treject( bdbVars.error_required_fields );\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ( ! args.hasOwnProperty( 'format' ) || '' === args.format ) {\r\n\t\t\t\treject( bdbVars.error_required_fields );\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tresolve();\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport { BDB_Book_Taxonomies };","/* global $, bdbVars */\r\n\r\n/**\r\n * Make a request to the REST API\r\n *\r\n * @param {string} endpoint\r\n * @param {object} data\r\n * @param {string} method\r\n * @returns {Promise}\r\n */\r\nexport function apiRequest( endpoint, data = {}, method = 'POST' ) {\r\n\tconst options = {\r\n\t\tmethod: method,\r\n\t\turl: bdbVars.api_base + 'book-database/' + endpoint,\r\n\t\tbeforeSend: function ( xhr ) {\r\n\t\t\txhr.setRequestHeader( 'X-WP-Nonce', bdbVars.api_nonce );\r\n\t\t},\r\n\t\txhrFields: {\r\n\t\t\twithCredentials: true,\r\n\t\t},\r\n\t\tdata: data\r\n\t};\r\n\r\n\tconsole.log( 'API endpoint', endpoint );\r\n\r\n\treturn new Promise( function ( resolve, reject ) {\r\n\t\t$.ajax( options ).success( function ( response ) {\r\n\t\t\tconsole.log( 'Success response', response );\r\n\t\t\tresolve( response );\r\n\t\t} ).error( function ( qpXHR, textStatus, errorThrown ) {\r\n\t\t\tlet error = bdbVars.generic_erroc;\r\n\r\n\t\t\tif ( 'undefined' !== typeof qpXHR.responseJSON ) {\r\n\t\t\t\terror = qpXHR.responseJSON;\r\n\r\n\t\t\t\tif ( 'undefined' !== typeof error.message ) {\r\n\t\t\t\t\terror = error.message;\r\n\t\t\t\t}\r\n\t\t\t} else if ( 'undefined' !== typeof qpXHR.message ) {\r\n\t\t\t\terror = qpXHR.message;\r\n\t\t\t}\r\n\r\n\t\t\treject( error );\r\n\t\t} );\r\n\t} )\r\n}","export * from './api-request.js';\r\nexport * from './loaders.js';","/* global $, bdbVars */\r\n\r\n/**\r\n * Spin a button\r\n *\r\n *      - Disables the button\r\n *      - Saves the current button text to `data-text`\r\n *      - Changes the text to either a WP-Admin spinner or \"Please Wait...\"\r\n *\r\n * @param button\r\n */\r\nexport function spinButton( button ) {\r\n\r\n\tlet newText = bdbVars.is_admin ? '<span class=\"spinner is-active\"></span>' : bdbVars.please_wait;\r\n\r\n\tbutton.prop( 'disabled', true ).data( 'text', button.text() ).html( newText );\r\n\r\n}\r\n\r\n/**\r\n * Unspin a button\r\n *\r\n *      - Enables teh button\r\n *      - Sets the text to the `data-text` attribute value\r\n *\r\n * @param button\r\n */\r\nexport function unspinButton( button ) {\r\n\tbutton.prop( 'disabled', false ).text( button.data( 'text' ) );\r\n}","module.exports = jQuery;"],"sourceRoot":""}